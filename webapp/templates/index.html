<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EpicService</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background: var(--tg-theme-bg-color, #ffffff); color: var(--tg-theme-text-color, #000000); padding: 16px; padding-bottom: 80px; }
        .header { margin-bottom: 20px; }
        h1 { color: var(--tg-theme-button-color, #0088cc); font-size: 24px; margin-bottom: 8px; }
        .search-box { position: relative; margin-bottom: 20px; }
        .search-input { width: 100%; padding: 12px 16px; border: 2px solid var(--tg-theme-button-color, #0088cc); border-radius: 12px; font-size: 16px; background: var(--tg-theme-bg-color, #ffffff); color: var(--tg-theme-text-color, #000000); }
        .search-input:focus { outline: none; border-color: var(--tg-theme-link-color, #0088cc); }
        .tabs { display: flex; gap: 4px; margin-bottom: 16px; border-bottom: 1px solid var(--tg-theme-hint-color, #999999); overflow-x: auto; }
        .tab { padding: 12px 16px; background: none; border: none; color: var(--tg-theme-hint-color, #999999); cursor: pointer; font-size: 14px; border-bottom: 2px solid transparent; transition: all 0.3s; white-space: nowrap; }
        .tab.active { color: var(--tg-theme-button-color, #0088cc); border-bottom-color: var(--tg-theme-button-color, #0088cc); }
        .content { display: none; }
        .content.active { display: block; }
        .product-card, .list-item, .archive-item { background: var(--tg-theme-secondary-bg-color, #f0f0f0); border-radius: 12px; padding: 16px; margin-bottom: 12px; cursor: pointer; transition: transform 0.2s; }
        .product-card:active, .list-item:active, .archive-item:active { transform: scale(0.98); }
        .product-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .product-article { font-weight: bold; color: var(--tg-theme-button-color, #0088cc); font-size: 16px; }
        .product-status { background: #34c759; color: white; padding: 4px 8px; border-radius: 6px; font-size: 12px; font-weight: bold; }
        .product-name { font-size: 14px; margin-bottom: 12px; color: var(--tg-theme-text-color, #000000); }
        .product-details { display: flex; flex-direction: column; gap: 6px; font-size: 13px; color: var(--tg-theme-hint-color, #999999); }
        .product-detail-row { display: flex; justify-content: space-between; }
        .product-detail-label { font-weight: 500; }
        .product-detail-value { color: var(--tg-theme-text-color, #000000); }
        .product-detail-value.highlight { color: var(--tg-theme-button-color, #0088cc); font-weight: bold; }
        .product-detail-value.warning { color: #ff9500; font-weight: bold; }
        .product-detail-value.success { color: #34c759; font-weight: bold; }
        .list-header, .archive-header { display: flex; justify-content: space-between; margin-bottom: 8px; }
        .action-buttons { display: flex; gap: 8px; margin-bottom: 16px; }
        .save-btn { flex: 1; padding: 12px; background: #34c759; color: white; border: none; border-radius: 12px; font-size: 14px; font-weight: bold; cursor: pointer; }
        .clear-btn, .download-btn { flex: 1; padding: 12px; background: #ff3b30; color: white; border: none; border-radius: 12px; font-size: 14px; font-weight: bold; cursor: pointer; }
        .download-btn { background: var(--tg-theme-button-color, #0088cc); }
        .empty-state { text-align: center; padding: 40px 20px; color: var(--tg-theme-hint-color, #999999); }
        .empty-icon { font-size: 48px; margin-bottom: 16px; }
        .loader { text-align: center; padding: 20px; color: var(--tg-theme-hint-color, #999999); }
        .total-box { position: fixed; bottom: 0; left: 0; right: 0; background: var(--tg-theme-bg-color, #ffffff); border-top: 1px solid var(--tg-theme-hint-color, #999999); padding: 16px; display: flex; justify-content: space-between; align-items: center; }
        .total-text { font-size: 18px; font-weight: bold; }
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 1000; align-items: center; justify-content: center; }
        .modal.active { display: flex; }
        .modal-content { background: var(--tg-theme-bg-color, #ffffff); border-radius: 16px; padding: 24px; max-width: 90%; max-height: 80%; overflow-y: auto; }
        .quantity-selector { display: flex; align-items: center; gap: 16px; margin: 20px 0; justify-content: center; }
        .qty-btn { width: 40px; height: 40px; border-radius: 50%; border: 2px solid var(--tg-theme-button-color, #0088cc); background: var(--tg-theme-button-color, #0088cc); color: white; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .qty-display { font-size: 24px; font-weight: bold; min-width: 60px; text-align: center; }
        .quick-actions { display: flex; gap: 8px; margin-bottom: 16px; }
        .quick-btn { flex: 1; padding: 12px; background: var(--tg-theme-secondary-bg-color, #f0f0f0); color: var(--tg-theme-text-color, #000000); border: 2px solid var(--tg-theme-button-color, #0088cc); border-radius: 8px; font-size: 14px; cursor: pointer; transition: all 0.2s; }
        .quick-btn:active { transform: scale(0.95); background: var(--tg-theme-button-color, #0088cc); color: white; }
        .add-btn { width: 100%; padding: 16px; background: var(--tg-theme-button-color, #0088cc); color: var(--tg-theme-button-text-color, #ffffff); border: none; border-radius: 12px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 16px; }
        .delete-btn { background: #ff3b30; }
        .custom-input { width: 100%; padding: 12px; border: 2px solid var(--tg-theme-button-color, #0088cc); border-radius: 8px; font-size: 18px; text-align: center; margin: 16px 0; background: var(--tg-theme-bg-color, #ffffff); color: var(--tg-theme-text-color, #000000); }
        .archive-badge { display: inline-block; padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: bold; margin-left: 8px; }
        .archive-badge.main { background: #34c759; color: white; }
        .archive-badge.surplus { background: #ff9500; color: white; }
        .archive-date { font-size: 13px; color: var(--tg-theme-hint-color, #999999); }
        .success-icon { font-size: 64px; text-align: center; margin-bottom: 16px; }
        .success-message { text-align: center; font-size: 18px; font-weight: bold; margin-bottom: 24px; color: #34c759; }
    </style>
</head>
<body>
    <div class="header"><h1>üì¶ EpicService</h1><p id="userInfo">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p></div>
    <div class="tabs">
        <button class="tab active" onclick="switchTab('search')">üîç –ü–æ—à—É–∫</button>
        <button class="tab" onclick="switchTab('list')">üìã –°–ø–∏—Å–æ–∫</button>
        <button class="tab" onclick="switchTab('archives')">üìÅ –ê—Ä—Ö—ñ–≤</button>
    </div>
    <div id="searchTab" class="content active"><div class="search-box"><input type="text" id="searchInput" class="search-input" placeholder="–í–≤–µ–¥—ñ—Ç—å –∞—Ä—Ç–∏–∫—É–ª –∞–±–æ –Ω–∞–∑–≤—É..."></div><div id="searchResults"></div></div>
    <div id="listTab" class="content"><div id="listContent"></div></div>
    <div id="archivesTab" class="content"><div id="archivesContent"></div></div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ —É—Å–ø—ñ—Ö—É -->
    <div id="successModal" class="modal">
        <div class="modal-content">
            <div class="success-icon">‚úÖ</div>
            <div class="success-message">–°–ø–∏—Å–æ–∫ –∑–±–µ—Ä–µ–∂–µ–Ω–æ!</div>
            <p style="text-align: center; margin-bottom: 24px; color: var(--tg-theme-hint-color, #999999);">–§–∞–π–ª –¥–æ—Å—Ç—É–ø–Ω–∏–π –≤ —Ä–æ–∑–¥—ñ–ª—ñ "–ê—Ä—Ö—ñ–≤"</p>
            <div class="quick-actions">
                <button class="add-btn" style="margin: 0;" onclick="goToArchives()">üìÅ –í—ñ–¥–∫—Ä–∏—Ç–∏ –ê—Ä—Ö—ñ–≤</button>
            </div>
            <div class="quick-actions">
                <button class="add-btn" style="margin: 0; background: var(--tg-theme-secondary-bg-color, #f0f0f0); color: var(--tg-theme-text-color, #000000); border: 2px solid var(--tg-theme-button-color, #0088cc);" onclick="startNewSearch()">üîç –ù–æ–≤–∏–π –ø–æ—à—É–∫</button>
            </div>
        </div>
    </div>
    
    <div id="addModal" class="modal"><div class="modal-content"><h2 id="modalTitle"></h2><p id="modalPrice"></p><p id="modalAvailable"></p><div class="quick-actions"><button class="quick-btn" onclick="addAllAvailable()">‚ûï –î–æ–¥–∞—Ç–∏ –≤—Å–µ</button><button class="quick-btn" onclick="showCustomInput()">üî¢ –Ü–Ω—à–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å</button></div><div id="customInputBox" style="display: none;"><input type="number" id="customQtyInput" class="custom-input" placeholder="–í–≤–µ–¥—ñ—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å" min="1"><button class="add-btn" onclick="applyCustomQty()">‚úÖ –ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏</button></div><div id="normalSelector"><div class="quantity-selector"><button class="qty-btn" onclick="changeQty(-1)">‚àí</button><div class="qty-display" id="qtyDisplay">1</div><button class="qty-btn" onclick="changeQty(1)">+</button></div><button class="add-btn" onclick="confirmAdd()">üõçÔ∏è –î–æ–¥–∞—Ç–∏ –¥–æ —Å–ø–∏—Å–∫—É</button></div><button class="add-btn" style="background: #999; margin-top: 8px;" onclick="closeModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button></div></div>
    <div id="editModal" class="modal"><div class="modal-content"><h2 id="editModalTitle"></h2><p id="editModalPrice"></p><div class="quantity-selector"><button class="qty-btn" onclick="changeEditQty(-1)">‚àí</button><div class="qty-display" id="editQtyDisplay">1</div><button class="qty-btn" onclick="changeEditQty(1)">+</button></div><button class="add-btn" onclick="confirmUpdate()">‚úÖ –ó–±–µ—Ä–µ–≥—Ç–∏</button><button class="add-btn delete-btn" onclick="confirmDelete()">üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏</button><button class="add-btn" style="background: #999; margin-top: 8px;" onclick="closeEditModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button></div></div>
    <div class="total-box" id="totalBox" style="display: none;"><div class="total-text">–í—Å—å–æ–≥–æ: <span id="totalSum">0</span> –≥—Ä–Ω</div><div style="font-size: 14px; color: var(--tg-theme-hint-color, #999999);"><span id="totalItems">0</span> —Ç–æ–≤–∞—Ä—ñ–≤</div></div>
<script>
const tg = window.Telegram.WebApp; tg.expand(); const userId = tg.initDataUnsafe?.user?.id || 0; let currentQuantity = 1, editQuantity = 1, selectedProduct = null, editingItem = null, searchTimeout = null;
document.getElementById('userInfo').textContent = userId ? `–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á: ${tg.initDataUnsafe.user.first_name}` : '–¢–µ—Å—Ç–æ–≤–∏–π —Ä–µ–∂–∏–º';
function switchTab(tab) { document.querySelectorAll('.tab').forEach(t => t.classList.remove('active')); document.querySelectorAll('.content').forEach(c => c.classList.remove('active')); if (tab === 'search') { document.querySelector('.tab:nth-child(1)').classList.add('active'); document.getElementById('searchTab').classList.add('active'); } else if (tab === 'list') { document.querySelector('.tab:nth-child(2)').classList.add('active'); document.getElementById('listTab').classList.add('active'); loadList(); } else if (tab === 'archives') { document.querySelector('.tab:nth-child(3)').classList.add('active'); document.getElementById('archivesTab').classList.add('active'); loadArchives(); } }
function goToArchives() { document.getElementById('successModal').classList.remove('active'); switchTab('archives'); }
function startNewSearch() { document.getElementById('successModal').classList.remove('active'); switchTab('search'); document.getElementById('searchInput').focus(); }
document.getElementById('searchInput').addEventListener('input', (e) => { clearTimeout(searchTimeout); const query = e.target.value.trim(); if (query.length < 2) { document.getElementById('searchResults').innerHTML = ''; return; } searchTimeout = setTimeout(() => search(query), 500); });
async function search(query) { const results = document.getElementById('searchResults'); results.innerHTML = '<div class="loader">üîç –ü–æ—à—É–∫...</div>'; try { const response = await fetch('/api/search', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({query, user_id: userId}) }); const data = await response.json(); if (!data.products || data.products.length === 0) { results.innerHTML = '<div class="empty-state"><div class="empty-icon">üîç</div>–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</div>'; return; } results.innerHTML = data.products.map(p => `<div class="product-card" onclick='openAddModal(${JSON.stringify(p)})'><div class="product-header"><span class="product-article">üÜî ${p.article}</span><span class="product-status">‚úÖ –¢–æ–≤–∞—Ä –∑–Ω–∞–π–¥–µ–Ω–æ</span></div><div class="product-name">üìù ${p.name}</div><div class="product-details"><div class="product-detail-row"><span class="product-detail-label">üè¨ –í—ñ–¥–¥—ñ–ª:</span><span class="product-detail-value">${p.department}</span></div><div class="product-detail-row"><span class="product-detail-label">üìÇ –ì—Ä—É–ø–∞:</span><span class="product-detail-value">${p.group}</span></div><div class="product-detail-row"><span class="product-detail-label">‚è≥ –ë–µ–∑ —Ä—É—Ö—É (–º—ñ—Å):</span><span class="product-detail-value ${p.months_without_movement > 3 ? 'warning' : ''}">${p.months_without_movement}</span></div><div class="product-detail-row"><span class="product-detail-label">üí∞ –°—É–º–∞ –∑–∞–ª–∏—à–∫—É:</span><span class="product-detail-value highlight">${p.balance_sum.toFixed(2)} –≥—Ä–Ω</span></div><div class="product-detail-row"><span class="product-detail-label">üì¶ –î–æ—Å—Ç—É–ø–Ω–æ:</span><span class="product-detail-value success">${p.available}</span></div>${p.user_reserved > 0 ? `<div class="product-detail-row"><span class="product-detail-label">üõçÔ∏è –í —Ä–µ–∑–µ—Ä–≤—ñ (–∑ –≤–∞—à–∏–º —Å–ø–∏—Å–∫–æ–º):</span><span class="product-detail-value warning">${p.user_reserved} (${p.user_reserved_sum.toFixed(2)} –≥—Ä–Ω)</span></div>` : ''}</div></div>`).join(''); } catch (error) { results.innerHTML = '<div class="empty-state"><div class="empty-icon">‚ùå</div>–ü–æ–º–∏–ª–∫–∞ –ø–æ—à—É–∫—É</div>'; } }
function openAddModal(product) { selectedProduct = product; currentQuantity = 1; document.getElementById('modalTitle').textContent = product.article; document.getElementById('modalPrice').textContent = `–¶—ñ–Ω–∞: ${product.price.toFixed(2)} –≥—Ä–Ω`; document.getElementById('modalAvailable').textContent = `–î–æ—Å—Ç—É–ø–Ω–æ: ${product.available} —à—Ç.`; document.getElementById('qtyDisplay').textContent = currentQuantity; document.getElementById('customInputBox').style.display = 'none'; document.getElementById('normalSelector').style.display = 'block'; document.getElementById('customQtyInput').value = ''; document.getElementById('addModal').classList.add('active'); }
function closeModal() { document.getElementById('addModal').classList.remove('active'); }
function changeQty(delta) { currentQuantity = Math.max(1, Math.min(selectedProduct.available, currentQuantity + delta)); document.getElementById('qtyDisplay').textContent = currentQuantity; }
function addAllAvailable() { currentQuantity = selectedProduct.available; document.getElementById('qtyDisplay').textContent = currentQuantity; tg.HapticFeedback.notificationOccurred('success'); }
function showCustomInput() { document.getElementById('customInputBox').style.display = 'block'; document.getElementById('normalSelector').style.display = 'none'; document.getElementById('customQtyInput').focus(); }
function applyCustomQty() { const input = document.getElementById('customQtyInput'); const value = parseInt(input.value); if (isNaN(value) || value < 1) { tg.showAlert('‚ùå –í–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–µ —á–∏—Å–ª–æ'); return; } if (value > selectedProduct.available) { tg.showAlert(`‚ö†Ô∏è –ú–∞–∫—Å–∏–º—É–º –¥–æ—Å—Ç—É–ø–Ω–æ: ${selectedProduct.available} —à—Ç.`); return; } currentQuantity = value; document.getElementById('qtyDisplay').textContent = currentQuantity; document.getElementById('customInputBox').style.display = 'none'; document.getElementById('normalSelector').style.display = 'block'; tg.HapticFeedback.notificationOccurred('success'); }
async function confirmAdd() { try { const response = await fetch('/api/add', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ user_id: userId, product_id: selectedProduct.id, quantity: currentQuantity }) }); const data = await response.json(); if (data.success) { tg.showAlert(`‚úÖ ${data.message}`); closeModal(); loadList(); } else { tg.showAlert('‚ùå ' + data.message); } } catch (error) { tg.showAlert('‚ùå –ü–æ–º–∏–ª–∫–∞: ' + error.message); } }
function openEditModal(item) { editingItem = item; editQuantity = item.quantity; document.getElementById('editModalTitle').textContent = item.article; document.getElementById('editModalPrice').textContent = `–¶—ñ–Ω–∞: ${item.price.toFixed(2)} –≥—Ä–Ω`; document.getElementById('editQtyDisplay').textContent = editQuantity; document.getElementById('editModal').classList.add('active'); }
function closeEditModal() { document.getElementById('editModal').classList.remove('active'); }
function changeEditQty(delta) { editQuantity = Math.max(1, editQuantity + delta); document.getElementById('editQtyDisplay').textContent = editQuantity; }
async function confirmUpdate() { try { const response = await fetch('/api/update', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ user_id: userId, product_id: editingItem.product_id, quantity: editQuantity }) }); const data = await response.json(); if (data.success) { tg.showAlert(`‚úÖ ${data.message}`); closeEditModal(); loadList(); } else { tg.showAlert('‚ùå ' + data.message); } } catch (error) { tg.showAlert('‚ùå –ü–æ–º–∏–ª–∫–∞: ' + error.message); } }
async function confirmDelete() { if (!confirm('–í–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–≤–∞—Ä –∑—ñ —Å–ø–∏—Å–∫—É?')) return; try { const response = await fetch('/api/delete', { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ user_id: userId, product_id: editingItem.product_id }) }); const data = await response.json(); if (data.success) { tg.showAlert(`‚úÖ ${data.message}`); closeEditModal(); loadList(); } else { tg.showAlert('‚ùå ' + data.message); } } catch (error) { tg.showAlert('‚ùå –ü–æ–º–∏–ª–∫–∞: ' + error.message); } }
async function saveList() { try { const response = await fetch(`/api/save/${userId}`, { method: 'POST' }); const data = await response.json(); if (data.success) { tg.HapticFeedback.notificationOccurred('success'); if (data.cleared) { loadList(); } document.getElementById('successModal').classList.add('active'); } else { tg.showAlert('‚ùå ' + data.message); } } catch (error) { tg.showAlert('‚ùå –ü–æ–º–∏–ª–∫–∞: ' + error.message); } }
async function clearList() { if (!confirm('–û—á–∏—Å—Ç–∏—Ç–∏ –≤–µ—Å—å —Å–ø–∏—Å–æ–∫?')) return; try { const response = await fetch(`/api/clear/${userId}`, { method: 'POST' }); const data = await response.json(); if (data.success) { tg.showAlert(`‚úÖ ${data.message}`); loadList(); } else { tg.showAlert('‚ùå ' + data.message); } } catch (error) { tg.showAlert('‚ùå –ü–æ–º–∏–ª–∫–∞: ' + error.message); } }
async function loadList() { const content = document.getElementById('listContent'); content.innerHTML = '<div class="loader">‚è≥ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>'; try { const response = await fetch(`/api/list/${userId}`); const data = await response.json(); if (!data.items || data.items.length === 0) { content.innerHTML = '<div class="empty-state"><div class="empty-icon">üì¶</div>–°–ø–∏—Å–æ–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π</div>'; document.getElementById('totalBox').style.display = 'none'; return; } let html = '<div class="action-buttons">'; html += '<button class="save-btn" onclick="saveList()">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ —Å–ø–∏—Å–æ–∫</button>'; html += '<button class="clear-btn" onclick="clearList()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏</button>'; html += '</div>'; html += data.items.map(item => `<div class="list-item" onclick='openEditModal(${JSON.stringify(item)})'><div class="list-header"><strong>${item.article}</strong><span class="product-price">${item.total.toFixed(2)} –≥—Ä–Ω</span></div><div>${item.name}</div><div style="margin-top: 8px; color: var(--tg-theme-hint-color, #999999);">${item.quantity} —à—Ç. √ó ${item.price.toFixed(2)} –≥—Ä–Ω</div></div>`).join(''); content.innerHTML = html; document.getElementById('totalSum').textContent = data.total.toFixed(2); document.getElementById('totalItems').textContent = data.count; document.getElementById('totalBox').style.display = 'flex'; } catch (error) { content.innerHTML = '<div class="empty-state"><div class="empty-icon">‚ùå</div>–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</div>'; } }
async function loadArchives() { const content = document.getElementById('archivesContent'); content.innerHTML = '<div class="loader">üìÅ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞—Ä—Ö—ñ–≤—É...</div>'; try { const response = await fetch(`/api/archives/${userId}`); const data = await response.json(); if (!data.archives || data.archives.length === 0) { content.innerHTML = '<div class="empty-state"><div class="empty-icon">üìÅ</div>–ê—Ä—Ö—ñ–≤ –ø–æ—Ä–æ–∂–Ω—ñ–π</div>'; return; } let html = data.archives.map(arc => `<div class="archive-item"><div class="archive-header"><div><strong>üìÑ ${arc.date}</strong><span class="archive-badge ${arc.is_surplus ? 'surplus' : 'main'}">${arc.type}</span></div></div><div style="margin-top: 8px;"><button class="download-btn" onclick="downloadArchive('${arc.filename}')">üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</button></div></div>`).join(''); content.innerHTML = html; } catch (error) { content.innerHTML = '<div class="empty-state"><div class="empty-icon">‚ùå</div>–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</div>'; } }
function downloadArchive(filename) { window.open(`/api/archive/download/${filename}`, '_blank'); tg.HapticFeedback.notificationOccurred('success'); }
if (userId) { loadList(); }
</script>
</body>
</html>
